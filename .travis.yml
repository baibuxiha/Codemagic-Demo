os: osx
language: generic
before_script:
- brew update
- brew install --HEAD usbmuxd
- brew unlink usbmuxd
- brew link usbmuxd
- brew install --HEAD libimobiledevice
- brew install ideviceinstaller
- brew install ios-deploy
- git clone https://github.com/flutter/flutter.git -b beta --depth 1
script:
- flutter/bin/flutter build ios --debug --no-codesign
cache:
  directories:
  - "$HOME/.pub-cache"
before_deploy:
- pushd build/ios/iphoneos
- mkdir Payload
- cd Payload
- ln -s ../Runner.app
- cd ..
- zip -r app.ipa Payload
- popd
deploy:
  provider: releases
  api_key:
    secure: WkXnHOjFy6f/Ymtklk4Jnn4MAhC9fS1MWFL7rfer/zLo/h6peng/Wz1i5CjIMlCwZ294VuwTmk4Bazdp0leChH9aOiTPYKHglcHdUdQCn0qkU9gfsf0iVYK4w4RVMNzSMdapyTMPyRHuqunWtJlYEZqkql7ucZRdbcnUWmXnql9Y4QYDy7G2Ihp1G11SSyDV+DkB+Mv7ftizEFOWfULLn2AN4NeIteycNJKVrKQbhMjsAoPXT73a98V7BhF2SR4ReHrMSszZPKzs1dFM26kvAhFzUvd+alpX0kY/o9OkRZp46OfUG69MIbDlaz/9iMbL70twWsbXRJKFm3M4+PusPQmrsLjuqC2d3mZy9Ou5cy9GiPDONKiZ1vCcA5Hm4TsTga9WUDux72dE1rezUC8SMUWFGNtoOhb/4Oe8YI48l7DBzBbVlAOLkbtd1nfqwQoecMwziyU5UmWVVdbASugTsa0XF3NG3pJtaDwUT3mzrfMbQwrPagNUDDxVY7IGf63wJfcqYaRkW93u6RJ+rYPBZhPRk+usvWI/6dMB/IN2J9A7Lq0BfJpThMT9h0XdiBTlj/zjpOg25gCXqdfgEW3f89aV3fLmey14JY1fhKA6ueDZRz2p7Y4La5i7PYYKcNFem7xJLpCiwkIa1reD1X/r0c8wjHLVY3jBBQk/wi1qpTI=
  file: build/ios/iphoneos/app.ipa
  skip_cleanup: true
  on:
    repo: baibuxiha/Codemagic-Demo
